# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/vendor/ys-text/index.css— корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
## Данные и типы данных,используемые в приложении
 
```
Карточка

export interface ICard {
	_id: string;
	name: string;
	description: string;
	image: string;
	price: number | null;
}

```
Заказ

export interface IOrder {
  payment: string;
	adress: string;
	email: string;
	phone: number;
}

```
Интерфейс для модели данных карточек

export interface ICardData {
	cards: ICard[];
	preview: string | null;
}
```


## Архитектура приложения
Код приложения разделен на слои согласно парадигме MVP.

Данный подход позволяет создавать абстракцию представления. Для этого необходимо выделить интерфейс представления с определенным набором свойств и методов. Презентер, в свою очередь, получает ссылку на реализацию интерфейса, подписывается на события представления и по запросу изменяет модель.

- слой представления, отвечает за отображение данных на странице;
- слой данных, отвечает за хранение данных;
- презентер,отвечает за связь представления и данных.

### Базовый код

#### Класс API
Содержит в себе базовую логику отправки запросов.
В конструктор передается базовый адрес сервера и опциональный объект с заголовками запросов.
Методы:
-`get` - выполняет запрос на переданной в параметрах ендпоинт и возвращает промис с объектом,которым ответил сервер.
-`post`- принимает объект с данными,которые будут переданы в JSON в теле запроса, и отправляет эти данные на ендпоинт переданный как параметр при вызове метода. По умолчанию выполняется `POST` запрос, но метод запроса может быть переопределен заданием третьего параметра при вызове.

####  Класс EventEmitter

Реализует паттерн «Наблюдатель» и позволяет подписываться на события и уведомлять подписчиков
о наступлении события.
Класс имеет методы on ,  off ,  emit  — для подписки на событие, отписки от события и уведомления
подписчиков о наступлении события соответственно.
Дополнительно реализованы методы  onAll и  offAll  — для подписки на все события и сброса всех
подписчиков.
Интересным дополнением является метод  trigger , генерирующий заданное событие с заданными
аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти
классы будут генерировать события, не будучи при этом напрямую зависимыми от
класса  EventEmitter .

## Слой данных

#### Класс CardsData

Класс отвечает за логику работы с данными карточек.\
Конструктор класса принимает инстант брокера событий.\
В полях класса хранятся следующие данные:
-_cards:ICard[]- массив объектов карточек
-_preview:string|null- id карточки, выбранной для просмотра.


#### Класс IOrderData

Класс отвечает за хранение и логику работы с данными пользователя.\
Конструктор класса принимает инстант брокера событий.\
В полях класса хранятся следующие данные:
-payment: string - Выбор способа оплаты заказа
-adress:string - Адрес доставки
-email: string -  Электронная почта пользователя
-phone: number - Телефон пользователя





### Классы представления

Все классы представления отвечают за отображение внутри контейнера (DOM-элемент)
передаваемых в них данных.

#### Класс Modal 

Реализует модальное окно. Также представляет методы `open` и `close` для управления отображения модального окна.
Устанавливает слушатели на клик в оверлей и на кнопку крестик для закрытия попапа.
-constructor(selector:string, events:IEvents) Конструктор принимает селектор, по которому в разметке страницы будет идентифицировано модальное окно и экземпляр класса `EventEmmiter` для возможности инициаций событий.

Поля класса
-modal: HTMLElement-элемент модального окна
-events:IEvents-брокер событий

### Класс ModalWithConfirm 

Расширяет класс Modal. Предназначен для реализации модального окна подтверждения. При открытии модального окна сохраняет полученный в параметрах обработчик,который передается для выполнения при сабмите формы.\
Поля класса
-submitButton: HTMLButtonElement-Кнопка подтверждения
-_form: HTMLFormElement-Элемент формы
-_formName: string - значение атрибута name формы
-_handleSubmit: Function- функция, на выполнение которой запрашивается подтверждение.
 Методы:
 -setValid(isValid:boolean):void-изменяет активность кнопки подтверждения
 -open(handleSubmit: Function):void-расширение родительского метода, принимает обработчик,который передается при инициации события подтверждения
 -get form-HTMLElement-геттер для получения элемента формы

### Класс ModalWithForm

Расширяет класс Modal. Предназначен для реализации модального окна с формой содержащей поле ввода. При сабмите инициирует событие передавая в него объект с данными из полей ввода формы. Предоставляет методы для управления активности кнопки сохранения.\
Поля класса: 
-submitButton:HTMLElement-Кнопка подтверждения
_form: HTMLFormElement-Элемент формы
_formName: string - значение атрибута name формы
Методы:
-setValid(isValid:boolean):void-изменяет активность кнопки подтверждения
-getInputValues(): Record<string,string>-возвращает объект с данными из полей формы,где ключ-name инпута,а значение-данные введенные пользователем

#### Класс Card 

Отвечает за отображение карточки,задавая карточке данные названия, изображения,цены.
Класс используется для отображения карточек на странице сайта.
Поля класса содержат элементы разметки элементов карточек.Конструктор принимает экземпляр `EventEmitter` для инициации событий.
Методы:
-геттер id-уникальный id карточки

#### Класс CardsContainer
 
Отображает за изображение блока с карточками на главной странице. В конструктор принимает контейнер, в котором размещаются карточки.

#### Класс OrderInfo

Отвечает за блок сайта с информацией о заказе.
Конструктор принимает имя блока, родительский элемент и обработчик событий.

### Слой коммуникации

## Класс AppApi

Принимает в конструктор экземпляр класса Api и представляет методы реализующие взаимодействие с бекэндом сервиса.

## Взаимодействие компонентов

Код, описывающий взаимодействие представления и данных между собой находится в файле `index.ts`, выполняющем роль презентера.\
Взаимодействие за счет событий генерируемых с помощью брокера событий и обработчиков этих событий, описанных в `index.ts`.\
В `index.ts` сначала создаются экземпляры всех необходимых классов, а затем настраивается обработка событий.

